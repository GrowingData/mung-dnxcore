
<!DOCTYPE html>
<html>
<head>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="stylesheet" href="/lib/font-awesome-4.5.0/css/font-awesome.css" />

	<link rel="stylesheet" href="/static/css/map.css" />

	<script src="/lib/jquery-2.1.4/jquery-2.1.4.js"></script>

	<script type="text/javascript">
		var MUNG = MUNG || {};
		MUNG.Loader = {
			startTime: new Date(),
			loadCallbacks: [],
			graphReadyCallbacks: [],
			ready: function (callback) {
				this.loadCallbacks.push(callback);
				return this;
			},
			graphReady: function (initCallback) {
				var scriptBlock = document.currentScript;
				this.graphReadyCallbacks.push({
					elem: scriptBlock,
					callback: initCallback
				});
				//this.load(function () {
				//	var graph = $(scriptBlock).parents(".graph").first();
				//	initCallback(graph);
				//})
			},
			fire: function () {
				console.log("Ready start: " + elapsed + "ms")
				var d = new Date();
				var elapsed = d.getTime() - this.startTime.getTime();

				for (var i = 0; i < this.loadCallbacks.length; i++) {
					this.loadCallbacks[i]();
				}
			}
		};

		// Shortcut functions
		MUNG.ready = function (fn) {
			MUNG.Loader.ready(fn);
		};
		MUNG.graphReady = function (fn) {
			MUNG.Loader.graphReady(fn);
		};


		MUNG.filterReady = function (filtersObj) {
			var scriptBlock = document.currentScript;
			$(scriptBlock).parents(".location").data("filter", filtersObj);
		}

		function getUrlPath(fullUrl) {
			var parts = fullUrl.split("/");
			var pathParts = parts.splice(3, parts.length - 2);
			return "/" + pathParts.join("/");
		}
		function convertHex(hex, opacity) {
			hex = hex.replace('#', '');
			r = parseInt(hex.substring(0, 2), 16);
			g = parseInt(hex.substring(2, 4), 16);
			b = parseInt(hex.substring(4, 6), 16);

			result = 'rgba(' + r + ',' + g + ',' + b + ',' + opacity + ')';
			return result;
		}

	</script>

	<title>Another one - Gooroo.io</title>

</head>
<body>
	<div class="map">
		<h1 style="margin:0">Gooroo Today</h1>
		<div class="map-grouping anonymous" data-color="ffe8af">
			<h1>Anonymous activites</h1>
			<div class="location" data-event-types="ping">
				<script type="text/javascript">
					MUNG.filterReady({
						url: function (x) { return getUrlPath(x) == "/"; },
						gooroo_id: function (x) { return x == -1; }
					});
				</script>

				<pre class="filter">{"url": "__.match('^/$')", "gooroo_id": "__ == -1" }</pre>
				<h2>Landing page</h2>
				<i class="fa fa-home"></i>
			</div>
			<div class="location" data-event-types="ping">
				<script type="text/javascript">
					MUNG.filterReady({
						url: function (x) { return new RegExp("^/gooroothink/article/", "i").test(getUrlPath(x)); },
						gooroo_id: function (x) { return x == -1; }
					});
				</script>
				<h2>Articles</h2>
				<i class="fa fa-newspaper-o"></i>
			</div>
			<div class="location" data-event-types="ping">
				<script type="text/javascript">
					MUNG.filterReady({
						url: function (x) { return new RegExp("^/analytics", "i").test(getUrlPath(x)); },
						gooroo_id: function (x) { return x == -1; }
					});
				</script>
				<h2>Skill Analytics</h2>
				<i class="fa fa-bar-chart"></i>
			</div>
			<div class="location" data-event-types="ping">
				<script type="text/javascript">
					MUNG.filterReady({
						url: function (x) { return new RegExp("^/g/", "i").test(getUrlPath(x)); },
						gooroo_id: function (x) { return x == -1; }
					});
				</script>
				<h2>Bio View</h2>
				<i class="fa fa-user-secret"></i>
			</div>
			<div class="clearfix"></div>
		</div>

		<div class="map-grouping onboard " data-color="add5d7">
			<h1>Onboarding</h1>
			<div class="location" data-event-types="ping">
				<script type="text/javascript">
					MUNG.filterReady({
						url: function (x) { return new RegExp("^/join$").test(getUrlPath(x)); },
						gooroo_id: function (x) { return x == -1; }
					});
				</script>
				<pre class="filter">{"url": "__.match('^/join$')", "gooroo_id": "__ == -1"}</pre>
				<h2>Join</h2>
				<i class="fa fa-user-plus"></i>
			</div>
			<div class="location" data-event-types="ping">
				<script type="text/javascript">
					MUNG.filterReady({
						url: function (x) { return new RegExp("^/onboard/select-areas$").test(getUrlPath(x)); },
						gooroo_id: function (x) { return x == -1; }
					});
				</script>
				<h2>Select areas</h2>
				<i class="fa fa-tags"></i>
			</div>
			<div class="location" data-event-types="ping">
				<script type="text/javascript">
					MUNG.filterReady({
						url: function (x) { return new RegExp("^/onboard/select-skills$").test(getUrlPath(x)); },
						gooroo_id: function (x) { return x == -1; }
					});
				</script>
				<h2>Select skills</h2>
				<i class="fa fa-briefcase"></i>
			</div>
			<div class="location" data-event-types="ping">
				<script type="text/javascript">
					MUNG.filterReady({
						url: function (x) { return new RegExp("^/onboard/refine-skills$").test(getUrlPath(x)); },
						gooroo_id: function (x) { return x == -1; }
					});
				</script>
				<h2>Refine skills</h2>
				<i class="fa fa-edit"></i>
			</div>
			<div class="location" data-event-types="ping">
				<script type="text/javascript">
					MUNG.filterReady({
						url: function (x) { return new RegExp("^/onboard/select-cities$").test(getUrlPath(x)); },
						gooroo_id: function (x) { return x == -1; }
					});
				</script>
				<h2>Cities</h2>
				<i class="fa fa-map-marker"></i>
			</div>
			<div class="location" data-event-types="ping">
				<script type="text/javascript">
					MUNG.filterReady({
						url: function (x) { return new RegExp("^/onboard/finalize$").test(getUrlPath(x)); },
						gooroo_id: function (x) { return x == -1; }
					});
				</script>
				<h2>Finalize</h2>
				<i class="fa fa-trophy"></i>
			</div>
			<div class="clearfix"></div>
		</div>
		<div class="clearfix">
			<div class="map-grouping" data-color="ffcd34">
				<h1>GoorooMATCH</h1>
				<div class="location" data-event-types="ping">
					<script type="text/javascript">
						MUNG.filterReady({
							url: function (x) { return new RegExp("^/match$", "i").test(getUrlPath(x)) || new RegExp("^/match/profile", "i").test(getUrlPath(x)); },
							gooroo_id: function (x) { return x != -1; }
						});
					</script>
					<h2>Match</h2>
					<i class="fa fa-industry"></i>
				</div>
				<div class="location" data-event-types="ping">
					<script type="text/javascript">
						MUNG.filterReady({
							url: function (x) {
								return new RegExp("^/match/ad/", "i").test(getUrlPath(x))
							},
							gooroo_id: function (x) { return x != -1; }
						});
					</script>
					<h2>Job view</h2>
					<i class="fa fa-street-view"></i>
				</div>
			</div>
			<div class="map-grouping" data-color="47acb1">
				<h1>Analytics</h1>
				<div class="location" data-event-types="ping">
					<script type="text/javascript">
						MUNG.filterReady({
							url: function (x) { return new RegExp("^/dashboard", "i").test(getUrlPath(x)); },
							gooroo_id: function (x) { return x != -1; }
						});
					</script>
					<h2>Dashboard</h2>
					<i class="fa fa-dashboard"></i>
				</div>
				<div class="location" data-event-types="ping">
					<script type="text/javascript">
						MUNG.filterReady({
							url: function (x) { return new RegExp("^/analytics", "i").test(getUrlPath(x)); },
							gooroo_id: function (x) { return x != -1; }
						});
					</script>
					<h2>Skill Analytics</h2>
					<i class="fa fa-bar-chart"></i>
				</div>
			</div>

			<div class="map-grouping" data-color="f26522">
				<h1>GoorooTHINK</h1>
				<div class="location" data-event-types="ping">
					<script type="text/javascript">
						MUNG.filterReady({
							url: function (x) { return new RegExp("/gooroothink/article/", "i").test(getUrlPath(x)); },
							gooroo_id: function (x) { return x != -1; }
						});
					</script>
					<h2>View Article</h2>
					<i class="fa fa-newspaper-o"></i>
				</div>
				<div class="location" data-event-types="ping">
					<script type="text/javascript">
						MUNG.filterReady({
							url: function (x) {
								return new RegExp("/GoorooThink/Article/.+/Edit/.+", "i").test(getUrlPath(x));
							},
							gooroo_id: function (x) { return x != -1; }
						});
					</script>
					<h2>Edit Article</h2>
					<i class="fa fa-user-md"></i>
				</div>
			</div>

			<div class="map-grouping" data-color="676766">
				<h1>Bio</h1>
				<div class="location" data-event-types="ping">
					<script type="text/javascript">
						MUNG.filterReady({
							url_referrer: function (x) { return new RegExp("^/g/", "i").test(getUrlPath(x)); },
							gooroo_id: function (x) { return x != -1; }
						});
					</script>
					<h2>Bio view</h2>
					<i class="fa fa-user"></i>
				</div>
				<div class="location" data-event-types="ping">
					<script type="text/javascript">
						MUNG.filterReady({
							url_referrer: function (x) { return new RegExp("^/g/me", "i").test(getUrlPath(x)); },
							gooroo_id: function (x) { return x != -1; }
						});
					</script>
					<h2>Bio edit</h2>
					<i class="fa fa-user-md"></i>
				</div>
			</div>

		</div>
		<div class="clearfix"></div>
		<div class="map-grouping" data-color="add5d7" style="width:100%;">
			<h1>Active users</h1>
			<div class="users-ticker" data-event-types="ping">
				<ul class="user-list list-inline">
					<li class="template user-template user">
						<div class="user-photo"></div>
						<div class="user-name"></div>
						<ul class="mini-icons">

						</ul>
					</li>
				</ul>

			</div>
		</div>
	</div>


	<script src="/static/js/core/MUNG.Events.js"></script>
	<script src="/static/js/core/MUNG.Utilities.js"></script>
	<script src="/static/js/core/MUNG.DataHelpers.js"></script>
	<script src="/iconGraph.js"></script>
	<script src="/tickerUsers.js"></script>

	<script type="text/javascript">
		MUNG.ready(function () {
			var now = new Date();
			var dateStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());
			var dateEnd = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);

			var connection = MUNG.Events({
				since: dateStart,
				apiHost: "http://localhost:5000",
				appKey: "1XcN8GCd4WfmbB3N"
			});


			var icons = [];
			$(".location").each(function () {
				icons.push($(this).iconGraph(connection));
			});
			$(".users-ticker").each(function () {
				$(this).tickerUsers(connection, icons);
			});

			$(".map-grouping").each(function () {
				var group = $(this);
				var color = group.data("color").toString();
				if (color) {
					group.css({ "border-color": convertHex(color, 0.2) });
					group.find("i").css({ "color": convertHex(color, 1) });
					group.find(".chart-background").css({ "background": convertHex(color, 0.1), "border-color": convertHex(color, 0.4) });
					group.find(".chart-background i").css({ "background": convertHex(color, 0.4) });
					group.find(".chart-background i.active").css({ "background": convertHex(color, 1) });
				}
			});


		});
	</script>

	<script type="text/javascript">
		$(document).ready(function () {
			MUNG.Loader.fire();
		});

	</script>

</body>
</html>